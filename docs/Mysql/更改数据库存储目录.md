# 更改数据存储目录

1. 停止MySQL服务`systemctl stop mysql.service`
2. 创建新的数据存储目录`/data/mysql`
3. 复制MySQL数据到新的目录`cp -ar /var/lib/mysql /data/mysql`
4. 修改新的数据目录权限`chown -R mysql:mysql /data/mysql`
5. 修改MySQL配置文件`vim /etc/mysql/mysql.conf.d/mysqld.conf`
    
    ```bash
    datadir=/data/msyql
    ```
    

**注意：只修改MySQL配置文件不行，Ubuntu有访问控制系统`apparmor` ，还需修改相关文件**

1. 修改安全保护文件`vim /etc/apparmor.d/usr.sbin.mysqld`
    
    ```bash
    # Allow data dir access
    /var/lib/mysql/ r,
    /var/lib/mysql/** rwk,
    ```
    
    `/var/lib` 改为`/data`
    
2. 修改访问控制文件`vim /etc/apparmor.d/abstractions/mysql`
    
    ```bash
    /var/lib/mysql{,d}/mysql{,d}.sock rw,
    ```
    
    `/var/lib` 改为`/data`
    
3. 重启apparmor服务`systemctl restart apparmor.service`
4. 重启MySQL服务`systemctl restart mysql.service`
