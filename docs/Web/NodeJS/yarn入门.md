# yarnå…¥é—¨

## 1 - ç®€ä»‹

Yarn å¯¹ä½ çš„ä»£ç æ¥è¯´æ˜¯ä¸€ä¸ªè½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œ ä½ å¯ä»¥é€šè¿‡å®ƒä½¿ç”¨å…¨ä¸–ç•Œå¼€å‘è€…çš„ä»£ç ï¼Œæˆ–è€…åˆ†äº«è‡ªå·±çš„ä»£ç ç»™å…¨ä¸–ç•Œçš„å¼€å‘è€…ã€‚Yarn åšè¿™äº›äº‹æƒ…å¿«æ·ã€å®‰å…¨ã€å¯é ï¼Œæ‰€ä»¥ä½ ä¸ç”¨æ‹…å¿ƒä»€ä¹ˆã€‚

é€šè¿‡ Yarn ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–å¼€å‘è€…é’ˆå¯¹ä¸åŒé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œç®€åŒ–ä½ å¼€å‘è½¯ä»¶çš„è¿‡ç¨‹ã€‚ å¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ å¯ä»¥å°†å…¶ä¸ŠæŠ¥æˆ–è€…è´¡çŒ®è§£å†³æ–¹æ¡ˆã€‚ä¸€æ—¦é—®é¢˜è¢«ä¿®å¤ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ Yarn æ›´æ–°ã€‚

ä»£ç é€šè¿‡ **è½¯ä»¶åŒ…ï¼ˆpackageï¼‰** çš„æ–¹å¼è¢«å…±äº«ã€‚ä¸€ä¸ªè½¯ä»¶åŒ…é‡ŒåŒ…å«äº†æ‰€æœ‰éœ€è¦å…±äº«çš„ä»£ç ï¼Œä»¥åŠä¸€ä¸ªæè¿°è½¯ä»¶åŒ…ä¿¡æ¯çš„æ–‡ä»¶ `package.json` ï¼ˆå«åš **æ¸…å•**ï¼‰ã€‚

## 2 - å®‰è£…

> **ä» Yarn 1 è¿ç§»åˆ° Yarn 2**
>
> æˆ‘ä»¬ä¸€ç›´åœ¨ç¼–çº‚ [è¿ç§»æŒ‡å—](https://www.yarnpkg.cn/getting-started/migration)ï¼Œä¸ºä» Yarn 1 è¿ç§»åˆ° Yarn 2 æä¾›æœ‰ç”¨çš„å»ºè®®ã€‚è¯·æŸ¥çœ‹æ­¤æŒ‡å—ï¼Œå¦‚æœå‘ç°å°šæœªæ¶µç›–çš„å†…å®¹è¯·åé¦ˆï¼å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥é˜… [PnP å…¼å®¹åˆ—è¡¨](https://www.yarnpkg.cn/features/pnp#compatibility-table) å¹¶ [å¼€å¯ node-modules æ’ä»¶](https://www.yarnpkg.cn/getting-started/migration#if-required-enable-the-node-modules-plugin)ï¼

### å…³äºå…¨å±€å®‰è£…

åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ä½¿ç”¨å•ä¸ªåŒ…ç®¡ç†å™¨ä¸€ç›´æ˜¯ä¸ªé—®é¢˜ã€‚ä¸ºäº†ä¿æŒç¨³å®šï¼Œéœ€è¦è·¨ç¯å¢ƒå¹¶ä½¿ç”¨ç›¸åŒçš„åŒ…ç®¡ç†å™¨ç‰ˆæœ¬æ¥æ‰§è¡Œå®‰è£…æ“ä½œï¼Œå¦åˆ™æˆ‘ä»¬æœ‰å¯èƒ½åœ¨ç‰ˆæœ¬ä¹‹é—´å¼•å…¥æ„å¤–çš„é‡å¤§é£é™© - æ¯•ç«Ÿï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆé¦–å…ˆå¼•å…¥äº†é”æ–‡ä»¶ï¼ˆlockfileï¼‰çš„æ¦‚å¿µï¼åœ¨æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œç”±äº Yarn æ˜¯æ‚¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ä¾èµ–é¡¹ï¼Œå› æ­¤"é”å®šå®ƒ"ä¹Ÿæ˜¯åº”è¯¥çš„ã€‚

å› æ­¤ï¼ŒYarn 2 åŠæ›´é«˜ç‰ˆæœ¬åº”æŒ‰é¡¹ç›®ç®¡ç†ã€‚åˆ«æ‹…å¿ƒï¼Œæ”¹å˜å¾ˆå°ï¼åªéœ€ç¡®ä¿é¦–å…ˆåœ¨å…¨å±€å®‰è£… Yarn äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¯¥äºŒè¿›åˆ¶æ–‡ä»¶æ¥ç”Ÿæˆæœ¬åœ°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š

```text
npm install -g yarn
```

å½“ä½ ä½ éµå¾ªä¸Šè¿°è¯´æ˜ï¼ˆä»ä¸»ç›®å½•ä¸‹è¿è¡Œ `yarn --version` å‘½ä»¤å°†è¾“å‡ºç±»ä¼¼ `1.22.0` çš„ä¿¡æ¯ï¼‰ï¼Œè¯·è½¬åˆ°ä¸‹ä¸€èŠ‚ï¼Œäº†è§£å¦‚ä½•åœ¨é¡¹ç›®ä¸­å®é™…å¯ç”¨ Yarn 2ã€‚

> ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°å…¨å±€å®‰è£…çš„ Yarn æ˜¯å±äº â€œç»å…¸ç‰ˆæœ¬â€ åºåˆ—ï¼ˆå³ 1.xï¼‰ã€‚è¿™æ˜¯åˆ»æ„å®‰æ’çš„ï¼è¿™ä¸€å®‰æ’çš„ä¸€ä¸ªé¢å¤–å¥½å¤„æ˜¯ï¼Œä¸º Yarn 1 é…ç½®çš„é¡¹ç›®å°†ç»§ç»­ä½¿ç”¨ Yarn 1ï¼Œè€Œæ— éœ€çªç„¶å¼ºåˆ¶è¿ç§»åˆ° Yarn 2.x çš„é…ç½®æ ¼å¼ã€‚å¦‚æœ Yarn ä¸€å¼€å§‹å°±è¢«â€œé¡¹ç›®é”å®šâ€äº†ï¼Œæˆ‘ä»¬å°±ä¸å¿…è¿™æ ·åšäº†ï¼Œæ¯•ç«Ÿæ˜¯ [äº‹åè¯¸è‘›](https://en.wiktionary.org/wiki/hindsight_is_20/20) ğŸ˜‰

### æŒ‰é¡¹ç›®å®‰è£…

1. å…¨å±€å®‰è£… Yarn çš„æœ€æ–°ç‰ˆæœ¬ï¼š

```bash
npm install -g yarn
```

1. è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•ï¼š

```bash
cd ~/path/to/project
```

1. è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
yarn set version berry
```

> "Berry" æ˜¯ Yarn 2 å‘å¸ƒåºåˆ—çš„ä»£å·ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æˆ‘ä»¬çš„ [ä»£ç ä»“åº“](https://github.com/yarnpkg/berry) çš„åç§°ï¼

1. æäº¤æ–°å¢å’Œä¿®æ”¹è¿‡çš„æ–‡ä»¶ã€‚å‚è§ [å“ªäº›æ–‡ä»¶éœ€è¦è¢«æ·»åŠ åˆ° .gitignore é…ç½®æ–‡ä»¶ä¸­ï¼Ÿ](https://www.yarnpkg.cn/getting-started/qa#which-files-should-be-gitignored)

### æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

å¦‚æœä»¥åè¦å°† Yarn æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·è¿è¡Œï¼š

```bash
yarn set version latest
```

Yarn å°†ä»æˆ‘ä»¬çš„ç½‘ç«™ä¸‹è½½æœ€æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å°†å…¶å®‰è£…åœ¨æ‚¨çš„é¡¹ç›®ä¸­ã€‚ç„¶åï¼Œä¸è¦å¿˜è®°æ›´æ–°ä¾èµ–é¡¹å¹¶æäº¤æ›´æ–°ç»“æœï¼

### å®‰è£… master åˆ†æ”¯çš„æœ€æ–°æ„å»ºç‰ˆæœ¬

éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå³ä½¿æœ€æ–°ç‰ˆæœ¬ä¹Ÿä¸å¤Ÿæ–°äº†ï¼Œé‚£ä¹ˆä½ å¯èƒ½å¸Œæœ›å°è¯•æœ€æ–°çš„ master ä»£ç åˆ†æ”¯ï¼Œä»¥æ£€æŸ¥ Bug æ˜¯å¦å·²ä¿®å¤ã€‚è¿™åœ¨ Yarn 2 ä¸­å·²ç»å˜å¾—éå¸¸ç®€å•äº†ï¼åªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š

```bash
yarn set version from sources
```

åŒæ ·çš„ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `--branch` å‚æ•°æ¥æŒ‡å®šè¦å®‰è£…ç‰¹å®šçš„ PRï¼š

```bash
yarn set version from sources --branch 1211
```

## 3 - ç”¨æ³•

ç°åœ¨ä½ å·²ç» [å®‰è£…äº†](https://www.yarnpkg.cn/getting-started/install) Yarnï¼Œé‚£å°±å¼€å§‹ä½¿ç”¨ Yarn å§ã€‚ä»¥ä¸‹åˆ—å‡ºçš„æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„å‘½ä»¤ã€‚

> **ä» Yarn 1 è¿ç§»åˆ° Yarn 2**
>
> æˆ‘ä»¬ä¸€ç›´åœ¨ç¼–çº‚ [è¿ç§»æŒ‡å—](https://www.yarnpkg.cn/getting-started/migration) ä¸ºä» Yarn 1 è¿ç§»åˆ° Yarn 2 æä¾›æœ‰ç”¨çš„å»ºè®®ã€‚è¯·æŸ¥çœ‹æ­¤æŒ‡å—ï¼Œå¦‚æœå‘ç°å°šæœªæ¶µç›–çš„å†…å®¹è¯·åé¦ˆç»™æˆ‘ä»¬ï¼å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥é˜… [PnP å…¼å®¹åˆ—è¡¨](https://www.yarnpkg.cn/features/pnp#compatibility-table) å¹¶ [å¼€å¯ node-modules æ’ä»¶](https://www.yarnpkg.cn/getting-started/migration#if-required-enable-the-node-modules-plugin)ï¼

### æ˜¾ç¤ºå‘½ä»¤åˆ—è¡¨

```bash
yarn help
```

### åˆå§‹åŒ–ä¸€ä¸ªæ–°é¡¹ç›®

```bash
yarn init
```

### å®‰è£…æ‰€æœ‰ä¾èµ–é¡¹

```bash
yarn
yarn install
```

### æ·»åŠ ä¾èµ–é¡¹

```bash
yarn add [package]
yarn add [package]@[version]
yarn add [package]@[tag]
```

### å°†ä¾èµ–é¡¹æ·»åŠ åˆ°ä¸åŒçš„ä¾èµ–ç±»åˆ«ä¸­

```bash
yarn add [package] --dev  # dev dependencies
yarn add [package] --peer # peer dependencies
```

### æ›´æ–°ä¾èµ–é¡¹

```bash
yarn up [package]
yarn up [package]@[version]
yarn up [package]@[tag]
```

### åˆ é™¤ä¾èµ–é¡¹

```bash
yarn remove [package]
```

### æ›´æ–° Yarn æœ¬ä½“

```bash
yarn set version latest
yarn set version from sources
```